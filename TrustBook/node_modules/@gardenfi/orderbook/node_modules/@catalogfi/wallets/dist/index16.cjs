"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const o=require("./index31.cjs"),i=require("./index32.cjs"),a=require("@catalogfi/encrypto");function c(s,t){const e=o.pbkdf2(i.sha256,s,t,{c:32,dkLen:32});return Buffer.from(e).toString("hex").slice(0,32)}class r{static{this.salt="c47a106f1c47a106"}constructor(t,e){this.store=t,this.key=c(e,r.salt)}async get(t){const e=await this.store.get(t);return e===null?null:a.decryptWithKey(e,this.key,r.salt).decryptedData}set(t,e){const n=a.encryptWithKey(e,this.key,r.salt);return this.store.set(t,n.encryptedData),Promise.resolve()}}class l{#t;constructor(){this.#t=new Map}get(t){return Promise.resolve(this.#t.get(t)||null)}set(t,e){return this.#t.set(t,e),Promise.resolve()}}exports.EncryptedStore=r;exports.WalletMemoryStore=l;
