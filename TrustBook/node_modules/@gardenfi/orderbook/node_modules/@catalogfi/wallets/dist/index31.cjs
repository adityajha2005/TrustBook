"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const k=require("./index37.cjs"),g=require("./index38.cjs"),w=require("./index39.cjs");function m(n,c,u,o){k.hash(n);const i=w.checkOpts({dkLen:32,asyncTick:10},o),{c:a,dkLen:r,asyncTick:t}=i;if(k.number(a),k.number(r),k.number(t),a<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const l=w.toBytes(c),s=w.toBytes(u),d=new Uint8Array(r),p=g.hmac.create(n,l),e=p._cloneInto().update(s);return{c:a,dkLen:r,asyncTick:t,DK:d,PRF:p,PRFSalt:e}}function L(n,c,u,o,i){return n.destroy(),c.destroy(),o&&o.destroy(),i.fill(0),u}function P(n,c,u,o){const{c:i,dkLen:a,DK:r,PRF:t,PRFSalt:l}=m(n,c,u,o);let s;const d=new Uint8Array(4),p=w.createView(d),e=new Uint8Array(t.outputLen);for(let h=1,f=0;f<a;h++,f+=t.outputLen){const y=r.subarray(f,f+t.outputLen);p.setInt32(0,h,!1),(s=l._cloneInto(s)).update(d).digestInto(e),y.set(e.subarray(0,y.length));for(let I=1;I<i;I++){t._cloneInto(s).update(e).digestInto(e);for(let b=0;b<y.length;b++)y[b]^=e[b]}}return L(t,l,r,s,e)}exports.pbkdf2=P;
